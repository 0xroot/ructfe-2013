#! /usr/bin/a+ -q

strip{s;l}: {
  (~sÅl)/s
}

r n: {
 xûnÒ' ';
 sys.read{0;x;n};
 strip{x;"\n"}
}

fget: {
 nameûr 16;
 strip{name;" "};
 nameûhash{name};
 read{name}
}

fput: {
  nameûr 16;
  valûr 32;
  strip{name;" "};
  strip{val;" "};
  sys.chdir{"files"};
  nameûhash{name};
  write{name;val}
}

list: {
  sys.agetdents "files"
}

hash str: {
  wû2 8 Ò str;
  vû > b¡ 1#w;
}

n y m: ô n ÷ ô m
x c: {
  wû¢1÷5Ùô¢1÷5Ùôc;
  s û +/+/> 1 0 ¢1 y¡ 3 Ò <> 1 0 ¢1 ÷¡ 3 Ò < w;
  (c ^ 4=s) © (3=s)
}

b{x}: {
    iû`int©x;
    3 3 Ò 0 ¨i^®Ä2*É8 
}


write{file;data}:{
if (0<fdûsys.open{file;
		  `O_CREAT`O_EXCL`O_WRONLY;
		  8Â6 4 4})
  {
    sys.write{fd;data;#data};
    sys.close{fd};
  };
}

read{file}: {
 sys.chdir{"files"};
 sys.readmat file
}
  
âr{4}

sys.exit 0